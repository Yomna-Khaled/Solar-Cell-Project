
<div class="container" style="width: calc(70%);">

  <h1 class="page-header" style="font-size:30px; color:#2A4E6E" ><span class="fa fa-users"> All Employees</span></h1>
  <section class="register" >  
    <div class="reg_section">
       <%= select_tag(:list, options_for_select([['ALL', 'all'], ['Current', 'current'],['Past','past']]),onchange: "searchemp()",class: "target col-md-3" ,style:"width:110px;margin-left:10px;margin-top:10px" ,id:"search") %>
       <div id="emp">
        <table class="table table-hover table-responsive">
          <thead>
            <tr>
              <th class="text-center"><h3>Image</h3></th>
              <th class="text-center"><h3>Full Name</h3></th>
              <th class="text-center"><h3>Salary</h3></th>
              <th class="text-center"><h3>Education Level</h3></th>
              <th class="text-center"><h3>Education</h3></th>
              <th class="text-center"><h3>Category</h3></th>
              <th class="text-center"><h3>Show</h3></th>
              <% if current_category.category!="Admin" %>
              <th class="text-center"><h3>Edit</h3></th>
              <%end%>
            </tr>
          </thead>
          <tbody>
            <% @employees.each do |employee| %>
            <tr>
              <td text-align="center"><%= image_tag employee.image.url(:thumb), :style=>"margin-left: auto; margin-right: auto" , class: "thumbnail" %></td>
              <td class="text-center"><%= employee.full_name %></td>
              <td class="text-center"><%= employee.salary %></td>
              <td class="text-center"><%= employee.education_level %></td>
              <td class="text-center"><%= employee.education %></td>
              <% category=Category.find_by(id: employee.category_id )%>
              <td class="text-center"><%= category.category %></td>
              <td class="text-center"><%= link_to 'Show', employee , class:"btn btn-info" %></td>
              <% if current_category.category!="Admin" %>
              <td class="text-center"><%= link_to 'Edit', edit_employee_path(employee), class:"btn btn-danger" %></td>
            <% if employee.status=="yes" %>
              <td class="text-center"><a class="btn btn-warning fire" id="<%= employee.id %>"> Remove</a></td>
              <% else %>
              <td class="text-center"><a class="btn btn-warning" id="<%= employee.id %>"> Not Available</a></td>
              <%end %>

              <%end%>
            </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </section>
  <%= will_paginate @employees, renderer: BootstrapPagination::Rails %>
</div>      

<script>
$(".fire").click(function(){
  console.log(this.id);
  var id =this.id;
  $.ajax({
      type: "POST",
      url: "/employees/fire",
      dataType: "JSON",
      data: { 'id':this.id},
      complete: function(data)
      {
         $("#"+id).html("Not Available");
        console.log($("#"+id));
      }
    });
});
function searchemp(){
  console.log($("#search").val());
  var type=$("#search").val();
   $.ajax({
      type: "POST",
      url: "/employees/search",
      dataType: "JSON",
      data: { 'type':type},
      complete: function(data)
      {
         $("#emp").html(data.responseText);
        
      }
    });

}
</script>
